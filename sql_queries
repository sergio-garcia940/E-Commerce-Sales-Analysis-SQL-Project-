01_monthly_revenue.sql

SELECT
  FORMAT_DATE('%Y-%m', DATE(order_purchase_timestamp)) AS year_month,
  ROUND(SUM(payment_value),2) AS total_revenue
FROM `ecommerce_analysis.olist_orders_dataset` o
JOIN `ecommerce_analysis.olist_order_payments_dataset` p
  ON o.order_id = p.order_id
WHERE o.order_status = 'delivered'
GROUP BY year_month
ORDER BY year_month;

02_mom_growth.sql

WITH monthly_revenue AS (
  SELECT
    FORMAT_DATE('%Y-%m', DATE(order_purchase_timestamp)) AS year_month,
    SUM(payment_value) AS total_revenue
  FROM `ecommerce_analysis.olist_orders_dataset` o
  JOIN `ecommerce_analysis.olist_order_payments_dataset` p
    ON o.order_id = p.order_id
  WHERE o.order_status = 'delivered'
  GROUP BY year_month
)

SELECT
  year_month,
  ROUND(total_revenue,2) AS total_revenue,
  ROUND(
    100 * (total_revenue - LAG(total_revenue) OVER (ORDER BY year_month))
    / LAG(total_revenue) OVER (ORDER BY year_month),
  2) AS mom_growth_percent
FROM monthly_revenue
ORDER BY year_month;
